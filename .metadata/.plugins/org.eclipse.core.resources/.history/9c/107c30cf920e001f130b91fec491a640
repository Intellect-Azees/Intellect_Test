package Utilities;

import java.io.FileInputStream;
import java.io.FileOutputStream;

import org.apache.poi.ss.usermodel.DataFormatter;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.apache.poi.ss.usermodel.*;

public class Test_Data
{
	public String  dataUtility(String sheetname,int rownum,int cellnum) throws Exception
	{
		FileInputStream fis=new FileInputStream("D:\\selenium\\Membership_TestData.xlsx");
		Workbook book=WorkbookFactory.create(fis);
		Sheet exlsheet=book.getSheet(sheetname);
		DataFormatter formatter=new DataFormatter();
		String data=formatter.formatCellValue(exlsheet.getRow(rownum).getCell(cellnum));
		return data;
	}
	public static void updateData(String sheetName, int rowNum, int cellNum, String newData) throws Exception {
        String filePath = "D:\\selenium\\Membership_TestData.xlsx";

        FileInputStream fis = new FileInputStream(filePath);
        Workbook workbook = WorkbookFactory.create(fis);
        Sheet sheet = workbook.getSheet(sheetName);

        // Check if the sheet, row, and cell exist
        Row row = sheet.getRow(rowNum);
        if (row == null) {
            throw new RuntimeException("Row " + rowNum + " does not exist in the sheet.");
        }

        Cell cell = row.getCell(cellNum);
        if (cell == null) {
            throw new RuntimeException("Cell " + cellNum + " does not exist in the row.");
        }

        // Update the cell value
        cell.setCellValue(newData);

        // Write the changes back to the file
        FileOutputStream fos = new FileOutputStream(filePath);
        workbook.write(fos);
    }

}
